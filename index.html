<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tateti</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background-color: #f5f5f5;
  }
  .logo {
    display: block;
    margin: 20px auto;
    max-width: 150px;
    animation: fadeIn 1.5s ease-in-out;
  }
  @keyframes fadeIn {
    from {opacity: 0; transform: translateY(-20px);}
    to {opacity: 1; transform: translateY(0);}
  }
  .board {
    display: grid;
    grid-template-columns: repeat(3, 100px);
    grid-template-rows: repeat(3, 100px);
    gap: 5px;
    justify-content: center;
    margin-top: 20px;
  }
  .cell {
    background: white;
    font-size: 2em;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: background 0.3s;
  }
  .cell:hover {
    background: #e0e0e0;
  }
  .controls {
    margin-top: 20px;
  }
</style>
</head>
<body>
<img src="logo.png" alt="Logo Colegio" class="logo">
<h1>Tateti</h1>
<div class="controls">
  <label for="mode">Modo de juego:</label>
  <select id="mode">
    <option value="2p">2 Jugadores</option>
    <option value="1p">1 Jugador vs CPU</option>
  </select>
  <label for="difficulty">Dificultad CPU:</label>
  <select id="difficulty">
    <option value="easy">FÃ¡cil</option>
    <option value="medium">Medio</option>
    <option value="hard">Imposible</option>
  </select>
  <button onclick="resetGame()">Reiniciar</button>
</div>
<div class="board" id="board"></div>
<h2 id="status"></h2>
<script>
  const boardEl = document.getElementById('board');
  const statusEl = document.getElementById('status');
  let board = Array(9).fill(null);
  let currentPlayer = 'X';
  let mode = '2p';
  document.getElementById('mode').addEventListener('change', e => {
    mode = e.target.value;
    resetGame();
  });

  function renderBoard(){
    boardEl.innerHTML = '';
    board.forEach((cell, i) => {
      const cellEl = document.createElement('div');
      cellEl.className = 'cell';
      cellEl.textContent = cell;
      cellEl.addEventListener('click', () => handleMove(i));
      boardEl.appendChild(cellEl);
    });
  }

  function handleMove(index){
    if(board[index] || checkWinner()) return;
    board[index] = currentPlayer;
    if(checkWinner()){
      statusEl.textContent = `${currentPlayer} gana!`;
    } else if(board.every(cell => cell)){
      statusEl.textContent = 'Empate';
    } else {
      currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
      if(mode === '1p' && currentPlayer === 'O'){
        cpuMove();
      }
    }
    renderBoard();
  }

  function cpuMove(){
    let difficulty = document.getElementById('difficulty').value;
    let move;
    if(difficulty === 'easy'){
      move = randomMove();
    } else if(difficulty === 'medium'){
      move = Math.random() < 0.5 ? randomMove() : bestMove();
    } else {
      move = bestMove();
    }
    handleMove(move);
  }

  function randomMove(){
    const available = board.map((v, i) => v ? null : i).filter(v => v !== null);
    return available[Math.floor(Math.random() * available.length)];
  }

  function bestMove(){
    let bestScore = -Infinity;
    let move;
    for(let i=0;i<9;i++){
      if(!board[i]){
        board[i] = 'O';
        let score = minimax(board, 0, false);
        board[i] = null;
        if(score > bestScore){
          bestScore = score;
          move = i;
        }
      }
    }
    return move;
  }

  function minimax(boardState, depth, isMaximizing){
    let winner = checkWinner();
    if(winner === 'O') return 10 - depth;
    if(winner === 'X') return depth - 10;
    if(boardState.every(cell => cell)) return 0;

    if(isMaximizing){
      let bestScore = -Infinity;
      for(let i=0;i<9;i++){
        if(!boardState[i]){
          boardState[i] = 'O';
          let score = minimax(boardState, depth + 1, false);
          boardState[i] = null;
          bestScore = Math.max(score, bestScore);
        }
      }
      return bestScore;
    } else {
      let bestScore = Infinity;
      for(let i=0;i<9;i++){
        if(!boardState[i]){
          boardState[i] = 'X';
          let score = minimax(boardState, depth + 1, true);
          boardState[i] = null;
          bestScore = Math.min(score, bestScore);
        }
      }
      return bestScore;
    }
  }

  function checkWinner(){
    const wins = [
      [0,1,2],[3,4,5],[6,7,8],
      [0,3,6],[1,4,7],[2,5,8],
      [0,4,8],[2,4,6]
    ];
    for(let [a,b,c] of wins){
      if(board[a] && board[a] === board[b] && board[a] === board[c]){
        return board[a];
      }
    }
    return null;
  }

  function resetGame(){
    board = Array(9).fill(null);
    currentPlayer = 'X';
    statusEl.textContent = '';
    renderBoard();
  }

  renderBoard();
</script>
</body>
</html>
